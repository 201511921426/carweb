<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.vip.car.mapper.CarMapper">
  <resultMap id="BaseResultMap" type="com.vip.car.domain.vo.CarVo">
    <id column="car_id" jdbcType="INTEGER" property="carId" />
    <result column="autotype_id" jdbcType="INTEGER" property="autotypeId" />
    <result column="brand_id" jdbcType="INTEGER" property="brandId" />
    <result column="color_id" jdbcType="INTEGER" property="colorId" />
    <result column="standard_id" jdbcType="INTEGER" property="standardId" />
    <result column="price_id" jdbcType="INTEGER" property="priceId" />
    <result column="num" jdbcType="INTEGER" property="num" />
    <result column="is_delete" jdbcType="TINYINT" property="isDelete" />
    <result column="carname" jdbcType="VARCHAR" property="carname" />
    <result column="prices" jdbcType="DOUBLE" property="prices" />
    <association property="brand" resultMap="com.vip.car.mapper.BrandMapper.BaseResultMap"/>
    <association property="price" resultMap="com.vip.car.mapper.PriceMapper.BaseResultMap"/>
    <association property="aotoType" resultMap="com.vip.car.mapper.AotoTypeMapper.BaseResultMap"/>
    <association property="standard" resultMap="com.vip.car.mapper.StandardMapper.BaseResultMap"/>
  </resultMap>

  <select id="findById" resultMap="BaseResultMap">
    select c.carname,c.prices,c.num,b.brand_name,p.price,a.autotypes,s.types
    from car c
    left join brand b on c.brand_id = b.brand_id
    left join price p on c.price_id = p.price_id
    left join aoto_type a on c.autotype_id = a.autotype_id
    left join standard s on c.standard_id = s.standard_id
    <trim prefix="where" prefixOverrides="and|or">
      <if test="brandId != null and brandId != ''">
        and c.brand_id=#{brandId}
      </if>
      <if test="priceId != null and priceId != ''">
        and c.price_id=#{priceId}
      </if>
      <if test="autotypeId != null and autotypeId != ''">
        and c.autotype_id=#{autotypeId}
      </if>
      <if test="standardId != null and standardId != ''">
        and c.standard_id=#{standardId}
      </if>
    </trim>
    and c.is_delete=0
    order by c.car_id
    limit #{page},#{size}
  </select>
</mapper>